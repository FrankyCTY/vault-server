import { head, includes, path, isNotNilOrEmpty } from "@frankycty/rm-extra";

export function getErrorResponse(error) {
  const payload = path(["output", "payload"], error);

  if (error.isJoi) {
    payload.message = head(error.details).message;
  }

  if (isNotNilOrEmpty(error.data)) {
    payload.context = error.data;
  }

  return payload;
}

export function getHttpStatusFromError(err, badRequestErrors) {
  if (includes(err.name, badRequestErrors)) {
    return 400;
  }

  return (err.output && err.output.statusCode) || err.status || 500;
}
